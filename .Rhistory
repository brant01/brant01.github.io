new_team <- new_team %>%
mutate(team_num = i) %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE)) %>%
ungroup()
for(j in 1:5000) {
temp_team <- new_team
position <- sample(1:9, 1)
if(position == 1){
new_player = sample_n(qb_bf, 1, replace = FALSE)
} else if(position > 1 & position < 4) {
new_player = sample_n(rb_bf, 1, replace = FALSE)
} else if(position > 3 & position < 7){
new_player = sample_n(wr_bf, 1, replace = FALSE)
} else if(position == 7){
new_player = sample_n(te_bf, 1, replace = FALSE)
} else if(position == 8){
new_player = sample_n(flex_bf, 1, replace = FALSE)
} else if(position == 9){
new_player = sample_n(dst_bf, 1, replace = FALSE)
}
new_player <- new_player %>%
mutate(team_num = i,
Tot_Salary = 0,
Tot_Points = 0)
temp_team[position, ] <- new_player[1, ]
temp_team <- temp_team %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE))  %>%
ungroup()
if(n_distinct(temp_team$plr_team) == 9 &
temp_team$Tot_Salary[1] <= 50000 &
temp_team$Tot_Points[1] > new_team$Tot_Points[1]){
new_team <- temp_team
} else
new_team <- new_team
track_row <- cbind(new_team$team_num[1], j, new_team$Tot_Points[1], new_team$Tot_Salary[1])
track <- rbind(track, track_row)
}
team_frame <- rbind(team_frame, new_team)
print(i)
}
team_frame <- team_frame %>%
select(team_num, Tot_Salary, Tot_Points, Min_Points, Max_Points, Position, plr_team,
points, Salary, Risk) %>%
arrange(desc(Tot_Points))
track <- track %>%
rename(Team_Num = V1,
Iteration = j,
Points = V3,
Salary = V4)
track %>%
ggplot(aes(x = Iteration, y = Points)) +
geom_line(aes(color = as.factor(Team_Num))) +
theme(legend.position="none")
team_frame %>%
select(team_num, Tot_Points) %>%
unique() %>%
ggplot(aes(x = team_num, y = Tot_Points)) +
geom_point()
print(sessionInfo())
View(team_frame)
track %>%
ggplot(aes(x = Iteration, y = Points)) +
geom_line(aes(color = as.factor(Team_Num))) +
theme(legend.position="none")
write_csv(team_frame,
"C:/Users/brantja/Desktop/Football/Projections/wk_2_100i_5000j_1.csv")
#Lineup
# 1 QB, 2 RB, 3 WR, TE, FLEX, DST
#Brute force
team_frame <- data.frame()
track <- data.frame()
for(i in 1:1000){
QB <- sample_n(qb_bf, 1, replace = FALSE)
RB <- sample_n(rb_bf, 2, replace = FALSE)
WR <- sample_n(wr_bf, 3, replace = FALSE)
TE <- sample_n(te_bf, 1, replace = FALSE)
FLEX <- sample_n(flex_bf, 1, replace = FALSE)
DST <- sample_n(dst_bf, 1, replace = FALSE)
new_team <- rbind(QB, RB, WR, TE, FLEX, DST)
new_team <- new_team %>%
mutate(team_num = i) %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE)) %>%
ungroup()
for(j in 1:10000) {
temp_team <- new_team
position <- sample(1:9, 1)
if(position == 1){
new_player = sample_n(qb_bf, 1, replace = FALSE)
} else if(position > 1 & position < 4) {
new_player = sample_n(rb_bf, 1, replace = FALSE)
} else if(position > 3 & position < 7){
new_player = sample_n(wr_bf, 1, replace = FALSE)
} else if(position == 7){
new_player = sample_n(te_bf, 1, replace = FALSE)
} else if(position == 8){
new_player = sample_n(flex_bf, 1, replace = FALSE)
} else if(position == 9){
new_player = sample_n(dst_bf, 1, replace = FALSE)
}
new_player <- new_player %>%
mutate(team_num = i,
Tot_Salary = 0,
Tot_Points = 0)
temp_team[position, ] <- new_player[1, ]
temp_team <- temp_team %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE))  %>%
ungroup()
if(n_distinct(temp_team$plr_team) == 9 &
temp_team$Tot_Salary[1] <= 50000 &
temp_team$Tot_Points[1] > new_team$Tot_Points[1]){
new_team <- temp_team
} else
new_team <- new_team
track_row <- cbind(new_team$team_num[1], j, new_team$Tot_Points[1], new_team$Tot_Salary[1])
track <- rbind(track, track_row)
}
team_frame <- rbind(team_frame, new_team)
print(i)
}
#Lineup
# 1 QB, 2 RB, 3 WR, TE, FLEX, DST
#Brute force
team_frame <- data.frame()
track <- data.frame()
for(i in 1:2000){
QB <- sample_n(qb_bf, 1, replace = FALSE)
RB <- sample_n(rb_bf, 2, replace = FALSE)
WR <- sample_n(wr_bf, 3, replace = FALSE)
TE <- sample_n(te_bf, 1, replace = FALSE)
FLEX <- sample_n(flex_bf, 1, replace = FALSE)
DST <- sample_n(dst_bf, 1, replace = FALSE)
new_team <- rbind(QB, RB, WR, TE, FLEX, DST)
new_team <- new_team %>%
mutate(team_num = i) %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE)) %>%
ungroup()
for(j in 1:8000) {
temp_team <- new_team
position <- sample(1:9, 1)
if(position == 1){
new_player = sample_n(qb_bf, 1, replace = FALSE)
} else if(position > 1 & position < 4) {
new_player = sample_n(rb_bf, 1, replace = FALSE)
} else if(position > 3 & position < 7){
new_player = sample_n(wr_bf, 1, replace = FALSE)
} else if(position == 7){
new_player = sample_n(te_bf, 1, replace = FALSE)
} else if(position == 8){
new_player = sample_n(flex_bf, 1, replace = FALSE)
} else if(position == 9){
new_player = sample_n(dst_bf, 1, replace = FALSE)
}
new_player <- new_player %>%
mutate(team_num = i,
Tot_Salary = 0,
Tot_Points = 0)
temp_team[position, ] <- new_player[1, ]
temp_team <- temp_team %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE))  %>%
ungroup()
if(n_distinct(temp_team$plr_team) == 9 &
temp_team$Tot_Salary[1] <= 50000 &
temp_team$Tot_Points[1] > new_team$Tot_Points[1]){
new_team <- temp_team
} else
new_team <- new_team
track_row <- cbind(new_team$team_num[1], j, new_team$Tot_Points[1], new_team$Tot_Salary[1])
track <- rbind(track, track_row)
}
team_frame <- rbind(team_frame, new_team)
print(i, max(team_frame$Tot_Points))
}
max(team_frame$Tot_Points)
#Lineup
# 1 QB, 2 RB, 3 WR, TE, FLEX, DST
#Brute force
team_frame <- data.frame()
track <- data.frame()
for(i in 1:2000){
QB <- sample_n(qb_bf, 1, replace = FALSE)
RB <- sample_n(rb_bf, 2, replace = FALSE)
WR <- sample_n(wr_bf, 3, replace = FALSE)
TE <- sample_n(te_bf, 1, replace = FALSE)
FLEX <- sample_n(flex_bf, 1, replace = FALSE)
DST <- sample_n(dst_bf, 1, replace = FALSE)
new_team <- rbind(QB, RB, WR, TE, FLEX, DST)
new_team <- new_team %>%
mutate(team_num = i) %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE)) %>%
ungroup()
for(j in 1:8000) {
temp_team <- new_team
position <- sample(1:9, 1)
if(position == 1){
new_player = sample_n(qb_bf, 1, replace = FALSE)
} else if(position > 1 & position < 4) {
new_player = sample_n(rb_bf, 1, replace = FALSE)
} else if(position > 3 & position < 7){
new_player = sample_n(wr_bf, 1, replace = FALSE)
} else if(position == 7){
new_player = sample_n(te_bf, 1, replace = FALSE)
} else if(position == 8){
new_player = sample_n(flex_bf, 1, replace = FALSE)
} else if(position == 9){
new_player = sample_n(dst_bf, 1, replace = FALSE)
}
new_player <- new_player %>%
mutate(team_num = i,
Tot_Salary = 0,
Tot_Points = 0)
temp_team[position, ] <- new_player[1, ]
temp_team <- temp_team %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE))  %>%
ungroup()
if(n_distinct(temp_team$plr_team) == 9 &
temp_team$Tot_Salary[1] <= 50000 &
temp_team$Tot_Points[1] > new_team$Tot_Points[1]){
new_team <- temp_team
} else
new_team <- new_team
track_row <- cbind(new_team$team_num[1], j, new_team$Tot_Points[1], new_team$Tot_Salary[1])
track <- rbind(track, track_row)
}
team_frame <- rbind(team_frame, new_team)
temp_max <-  max(team_frame$Tot_Points)
print(i, temp_max)
}
printc(i, temp_max)
#Lineup
# 1 QB, 2 RB, 3 WR, TE, FLEX, DST
#Brute force
team_frame <- data.frame()
track <- data.frame()
for(i in 1:2000){
QB <- sample_n(qb_bf, 1, replace = FALSE)
RB <- sample_n(rb_bf, 2, replace = FALSE)
WR <- sample_n(wr_bf, 3, replace = FALSE)
TE <- sample_n(te_bf, 1, replace = FALSE)
FLEX <- sample_n(flex_bf, 1, replace = FALSE)
DST <- sample_n(dst_bf, 1, replace = FALSE)
new_team <- rbind(QB, RB, WR, TE, FLEX, DST)
new_team <- new_team %>%
mutate(team_num = i) %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE)) %>%
ungroup()
for(j in 1:8000) {
temp_team <- new_team
position <- sample(1:9, 1)
if(position == 1){
new_player = sample_n(qb_bf, 1, replace = FALSE)
} else if(position > 1 & position < 4) {
new_player = sample_n(rb_bf, 1, replace = FALSE)
} else if(position > 3 & position < 7){
new_player = sample_n(wr_bf, 1, replace = FALSE)
} else if(position == 7){
new_player = sample_n(te_bf, 1, replace = FALSE)
} else if(position == 8){
new_player = sample_n(flex_bf, 1, replace = FALSE)
} else if(position == 9){
new_player = sample_n(dst_bf, 1, replace = FALSE)
}
new_player <- new_player %>%
mutate(team_num = i,
Tot_Salary = 0,
Tot_Points = 0)
temp_team[position, ] <- new_player[1, ]
temp_team <- temp_team %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE))  %>%
ungroup()
if(n_distinct(temp_team$plr_team) == 9 &
temp_team$Tot_Salary[1] <= 50000 &
temp_team$Tot_Points[1] > new_team$Tot_Points[1]){
new_team <- temp_team
} else
new_team <- new_team
track_row <- cbind(new_team$team_num[1], j, new_team$Tot_Points[1], new_team$Tot_Salary[1])
track <- rbind(track, track_row)
}
team_frame <- rbind(team_frame, new_team)
temp_max <-  max(team_frame$Tot_Points)
printc(i, temp_max)
}
#Lineup
# 1 QB, 2 RB, 3 WR, TE, FLEX, DST
#Brute force
team_frame <- data.frame()
track <- data.frame()
for(i in 1:2000){
QB <- sample_n(qb_bf, 1, replace = FALSE)
RB <- sample_n(rb_bf, 2, replace = FALSE)
WR <- sample_n(wr_bf, 3, replace = FALSE)
TE <- sample_n(te_bf, 1, replace = FALSE)
FLEX <- sample_n(flex_bf, 1, replace = FALSE)
DST <- sample_n(dst_bf, 1, replace = FALSE)
new_team <- rbind(QB, RB, WR, TE, FLEX, DST)
new_team <- new_team %>%
mutate(team_num = i) %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE)) %>%
ungroup()
for(j in 1:8000) {
temp_team <- new_team
position <- sample(1:9, 1)
if(position == 1){
new_player = sample_n(qb_bf, 1, replace = FALSE)
} else if(position > 1 & position < 4) {
new_player = sample_n(rb_bf, 1, replace = FALSE)
} else if(position > 3 & position < 7){
new_player = sample_n(wr_bf, 1, replace = FALSE)
} else if(position == 7){
new_player = sample_n(te_bf, 1, replace = FALSE)
} else if(position == 8){
new_player = sample_n(flex_bf, 1, replace = FALSE)
} else if(position == 9){
new_player = sample_n(dst_bf, 1, replace = FALSE)
}
new_player <- new_player %>%
mutate(team_num = i,
Tot_Salary = 0,
Tot_Points = 0)
temp_team[position, ] <- new_player[1, ]
temp_team <- temp_team %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE))  %>%
ungroup()
if(n_distinct(temp_team$plr_team) == 9 &
temp_team$Tot_Salary[1] <= 50000 &
temp_team$Tot_Points[1] > new_team$Tot_Points[1]){
new_team <- temp_team
} else
new_team <- new_team
track_row <- cbind(new_team$team_num[1], j, new_team$Tot_Points[1], new_team$Tot_Salary[1])
track <- rbind(track, track_row)
}
team_frame <- rbind(team_frame, new_team)
temp_max <-  max(team_frame$Tot_Points)
print(c(i, temp_max))
}
library("ggplot2")
library("dplyr")
library("tidyr")
library("knitr")
library("tableone")
library("forcats")
library("broom")
library("tibble")
library("readr")
library("stringr")
library("lubridate")
library("rvest")
library("readxl")
library("caret")
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
dat <- read_csv("C:/Users/brantja/Desktop/Football/FFA Stats Downloads/ffa_customrankings2018-2.csv")  %>%
select(player, team, position, points, lower, upper, risk)  %>%
mutate(plr_team = paste(player, team, sep = "_")) %>%
select(-player, - team)
dk_cost <- read_csv(file = "C:/Users/brantja/Desktop/Football/DK Salaries/DKSalaries_18_2.csv") %>%
select(Name, TeamAbbrev, Salary, Position) %>%
rename(player = Name) %>%
mutate(plr_team = paste(player, TeamAbbrev, sep = "_")) %>%
select(-player, -TeamAbbrev)
data <- inner_join(dat,
dk_cost,
by = "plr_team") %>%
select(-position) %>%
unique() %>%
select(plr_team, Salary, Position, points:risk)
data_analysis <- data %>%
group_by(plr_team) %>%
mutate(Num = n()) %>%
ungroup() %>%
filter(Num > 1)
#Lineup
# 1 QB, 2 RB, 3 WR, TE, FLEX, DST
qb_bf <- data %>%
filter(Position == "QB")
rb_bf <- data %>%
filter(Position == "RB")
wr_bf <- data %>%
filter(Position == "WR")
te_bf <- data %>%
filter(Position == "TE")
flex_bf <- data %>%
filter(Position == "WR" |
Position == "RB" |
Position == "TE")
dst_bf <- data %>%
filter(Position == "DST")
#Lineup
# 1 QB, 2 RB, 3 WR, TE, FLEX, DST
#Brute force
team_frame <- data.frame()
track <- data.frame()
for(i in 1:200){
QB <- sample_n(qb_bf, 1, replace = FALSE)
RB <- sample_n(rb_bf, 2, replace = FALSE)
WR <- sample_n(wr_bf, 3, replace = FALSE)
TE <- sample_n(te_bf, 1, replace = FALSE)
FLEX <- sample_n(flex_bf, 1, replace = FALSE)
DST <- sample_n(dst_bf, 1, replace = FALSE)
new_team <- rbind(QB, RB, WR, TE, FLEX, DST)
new_team <- new_team %>%
mutate(team_num = i) %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE)) %>%
ungroup()
for(j in 1:8000) {
temp_team <- new_team
position <- sample(1:9, 1)
if(position == 1){
new_player = sample_n(qb_bf, 1, replace = FALSE)
} else if(position > 1 & position < 4) {
new_player = sample_n(rb_bf, 1, replace = FALSE)
} else if(position > 3 & position < 7){
new_player = sample_n(wr_bf, 1, replace = FALSE)
} else if(position == 7){
new_player = sample_n(te_bf, 1, replace = FALSE)
} else if(position == 8){
new_player = sample_n(flex_bf, 1, replace = FALSE)
} else if(position == 9){
new_player = sample_n(dst_bf, 1, replace = FALSE)
}
new_player <- new_player %>%
mutate(team_num = i,
Tot_Salary = 0,
Tot_Points = 0)
temp_team[position, ] <- new_player[1, ]
temp_team <- temp_team %>%
group_by(team_num) %>%
mutate(Tot_Salary = sum(Salary, na.rm = TRUE),
Tot_Points = sum(points, na.rm = TRUE),
Max_Points = sum(upper, na.rm = TRUE),
Min_Points = sum(lower, na.rm = TRUE),
Risk = sum(risk, na.rm = TRUE))  %>%
ungroup()
if(n_distinct(temp_team$plr_team) == 9 &
temp_team$Tot_Salary[1] <= 50000 &
temp_team$Tot_Points[1] > new_team$Tot_Points[1]){
new_team <- temp_team
} else
new_team <- new_team
track_row <- cbind(new_team$team_num[1], j, new_team$Tot_Points[1], new_team$Tot_Salary[1])
track <- rbind(track, track_row)
}
team_frame <- rbind(team_frame, new_team)
temp_max <-  max(team_frame$Tot_Points)
print(c(i, temp_max))
}
View(team_frame)
